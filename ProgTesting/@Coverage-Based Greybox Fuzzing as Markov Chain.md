#program-test #fuzzing 

# Coverage-Based Greybox Fuzzing  as Markov Chain

coverage-based greybox fuzzing can be modeled as a Markov chain.

- A **state** $i$ is a specific **path** in the program.
- The **transition probability** $p_{ij}$ from state $i$ to state $j$ is given by the probability that fuzzing the seed which exercises path $i$ generates a seed which exercises path $j$.
- The chain specifies the probability $p_{ij}$ that  fuzzing the seed exercising path $i$ generates an input exercising path $j$.

## The Model

All the paths generated by the fuzzer include 2 types


##### State space

- Let the target programs **input space** be $D$, the set of program traces/paths is $\chi$
- **Seed set** $T\subset D$, seed $t \in T$ can be input of the target program.
- **Path**: let the path functor be denoted as $\xi:  D \to \chi$
>The are 2 types of paths can be visited by the fuzzer, i.e. the paths of the seed set $T$, and the paths of the generated input from $Ts$
- **State Space** $S$: The *discovered paths* and their *immediate neighbors*.
	- The fuzzer generates inputs from seed $t$. The generated input is a r.v. $X_t$,  $S_t=\{x_t^{(i)}\} \subset D$ are samples from $X_t$
	- Let $S^+ = \{\xi(t)|t \in T\}$
	- Let $S^- = \{\xi(x_t^{(i)}) | t\in T, 1\le i \le power(t) \}$


##### Transition probability

- If path $i$ is a discovered path exercised by $t_i \in T$ (i.e.,$i \in S^+$), then $p{ij}$ is the probability that randomly mutating seed $t_i$ generates an input that exercises the path $j$.
- Else if path $i$ is an undiscovered path that is not exercised by some $t \in T$ (i.e.,$i \in S^-$), then $p_{ii} = 1 - \sum_{j\in S^+} p_{ji}$. (this makes $\sum_j p_{i,j}=1$)

$$
p_{ij} = \begin{cases}
	P(X_{t_i} \in \xi^{-1}(j)) &\quad i \in S^+; \xi(t_i) = i \\
	p_{ji}                     &\quad i \notin S^+; j \in S^+ \\
	1 - \sum_{k\in S^+} p_{ki} &\quad i \notin S^+; i=j       \\
	0                          &\quad \textrm{otherwise}
	
\end{cases}
$$

##### Neighborhood (邻域)

$$
	O_\varepsilon(i) = B(i, \varepsilon) = \{ j \;|\; p_{ij} + p_{ji} > \varepsilon \}
$$


Let $\pi$ a distribution over $S$
  - ***high-density region*** if    
  $$\mu_{i\in I}(\pi_i)  > \mu_{j\in S^+}(\pi_j)$$
  - ***low-density region*** if
  $$\mu_{i\in I}(\pi_i)  < \mu_{j\in S^+}(\pi_j)$$
