# Trend Models




![[Pasted image 20220407154033.png]]


![[Pasted image 20220407200937.png]]



## Holt’s Linear Trend Method

$$
\begin{align}
\text{Forecast equation}:&& \;\; \hat y_{t+h|t} &= \ell_t + b_th \\
\text{Level equation}:&& \;\; \ell_t &= \alpha y_{t-1} + (1-\alpha)\hat y_{t|t-1} \\
&&& = \alpha y_{t-1} + (1-\alpha)(\ell_{t-1} + b_{t-1})\\
\text{Trend equation}:&& b_t &= \beta^*(\ell_t - \ell_{t-1}) + (1-\beta^*)b_{t-1}
\end{align}
$$
Note:
- $\hat y_{t|t-1}$ is an estimator of $\ell_t$
- $\ell_t - \ell_{t-1}$ is an estimate of $b_t$ 
- The forecasts generated by Holt’s linear method display a **constant trend** (increasing or decreasing) indefinitely into the future.
- Empirical evidence indicates that this method tend to over-forecast, especially for longer forecast horizons.

## Damped Trend Method

$$
\begin{align}
 \hat y_{t+h|t} &= \ell_t + b_t\sum_{i=1}^h\phi^i \\
 \ell_t &= \alpha y_{t-1} + (1-\alpha)\hat y_{t|t-1} \\
& = \alpha y_{t-1} + (1-\alpha)(\ell_{t-1} + b_{t-1}\phi)\\
 b_t &= \beta^*(\ell_t - \ell_{t-1}) + (1-\beta^*)b_{t-1}\phi
\end{align}
$$

Short-run forecasts are trended while **long-run forecasts are constant bounded**.

In practice, we usually restrict $\phi$ to a minimum of $0.8$ and a maximum of $0.98$.


# Season Model
additive
$$
\begin{align}
  \hat{y}_{t+h|t} &= \ell_{t} + hb_{t} + s_{t+h-m(k+1)} \\
  \ell_{t} &= \alpha(y_{t} - s_{t-m}) + (1 - \alpha)(\ell_{t-1} + b_{t-1})\\
  b_{t} &= \beta^*(\ell_{t} - \ell_{t-1}) + (1 - \beta^*)b_{t-1}\\
  s_{t} &= \gamma (y_{t}-\ell_{t}) + (1-\gamma)s_{t-m},
\end{align}
$$
 
 multiplicative
$$
\begin{align}
  \hat{y}_{t+h|t} &= (\ell_{t} + hb_{t})s_{t+h-m(k+1)} \\
  \ell_{t} &= \alpha \frac{y_{t}}{s_{t-m}} + (1 - \alpha)(\ell_{t-1} + b_{t-1})\\
  b_{t} &= \beta^*(\ell_{t}-\ell_{t-1}) + (1 - \beta^*)b_{t-1}                \\
  s_{t} &= \gamma \frac{y_{t}}{(\ell_{t-1} + b_{t-1})} + (1 - \gamma)s_{t-m}.
\end{align}
$$
 
 $k$ is the integer part of $(h−1)/m$, which ensures that the estimates of the seasonal indices used for forecasting come from the final year of the sample.

$$
\begin{align*}
  \hat{y}_{t+h|t} &= \left[\ell_{t} + (\phi+\phi^2 + \dots + \phi^{h})b_{t}\right]s_{t+h-m(k+1)} \\
  \ell_{t} &= \alpha(y_{t} / s_{t-m}) + (1 - \alpha)(\ell_{t-1} + \phi b_{t-1})\\
  b_{t} &= \beta^*(\ell_{t} - \ell_{t-1}) + (1 - \beta^*)\phi b_{t-1}             \\
  s_{t} &= \gamma \frac{y_{t}}{(\ell_{t-1} + \phi b_{t-1})} + (1 - \gamma)s_{t-m}.
\end{align*}
$$


# R Code

```r

aus_holidays <- tourism |>
  filter(Purpose == "Holiday") |>
  summarise(Trips = sum(Trips)/1e3)
  
fit <- aus_holidays |>
  model(
    additive = ETS(Trips ~ error("A") + trend("A") +
                                                season("A")),
    multiplicative = ETS(Trips ~ error("M") + trend("A") +
                                                season("M"))
  )
  
fc <- fit |> forecast(h = "3 years")

fc |>
  autoplot(aus_holidays, level = NULL) +
  labs(title="Australian domestic tourism",
       y="Overnight trips (millions)") +
  guides(colour = guide_legend(title = "Forecast"))

```


![[Pasted image 20220407153919.png]]


![[Pasted image 20220407153955.png]]


