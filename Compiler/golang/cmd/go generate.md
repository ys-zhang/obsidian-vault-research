`go generate`命令扫描与当前包相关的源代码文件，找出所有包含`//go:generate`的特殊注释，提取并执行该特殊注释后面的命令。

`go generate`命令格式如下所示：  

	go generate [-run regexp] [-n] [-v] [-x] [command] [build flags] [file.go... | packages]

参数说明如下：

-   `-run` 正则表达式匹配命令行，仅执行匹配的命令；
-   `-v` 输出被处理的包名和源文件名；
-   `-n` 显示不执行命令；
-   `-x` 显示并执行命令；
-   `command` 可以是在环境变量 PATH 中的任何命令。

see [[go-tool stringy]]

# 用途
在下面这些场景下，我们会使用`go generate`命令：  

- `yacc`：从 `.y` 文件生成 `.go` 文件；
- `protobufs`：从 `protocol buffer` 定义文件（`.proto`）生成 `.pb.go` 文件；
- `Unicode`：从 `UnicodeData.txt` 生成 `Unicode` 表；
- `HTML`：将 `HTML` 文件嵌入到 `go` 源码；
- `bindata`：将形如 `JPEG` 这样的文件转成 `go` 代码中的字节数组。

再比如：  

-   `string` 方法：为类似枚举常量这样的类型生成 `String()` 方法；
-   宏：为既定的泛型包生成特定的实现，比如用于 `ints` 的 `sort.Ints`

# Example: 使用 stringer 工具实现 String() 方法

stringer 并不是Go语言自带的工具，需要手动安装。我们可以通过下面的命令来安装 stringer 工具。  

	go get golang.org/x/tools/cmd/stringer

[Using Golang’s Stringer tool. | Medium](https://arjunmahishi.medium.com/golang-stringer-ad01db65e306)

首先，在项目目录下新建一个 painkiller 文件夹，并在该文件夹中创建 painkiller.go 文件，文件内容如下：

```go
//go:generate stringer -type=Pill
package painkiller
type Pill int
const (
    Placebo Pill = iota
    Aspirin
    Ibuprofen
    Paracetamol
    Acetaminophen = Paracetamol
)
```

然后，在 painkiller.go 文件所在的目录下运行`go generate`命令。

```go
// Code generated by "stringer -type=Pill"; DO NOT EDIT.
package painkiller
import "strconv"
func _() {
    // An "invalid array index" compiler error signifies that the constant values have changed.
    // Re-run the stringer command to generate them again.
    var x [1]struct{}
    _ = x[Placebo-0]
    _ = x[Aspirin-1]
    _ = x[Ibuprofen-2]
    _ = x[Paracetamol-3]
}

const _Pill_name = "PlaceboAspirinIbuprofenParacetamol"
var _Pill_index = [...]uint8{0, 7, 14, 23, 34}
func (i Pill) String() string {
    if i < 0 || i >= Pill(len(_Pill_index)-1) {
        return "Pill(" + strconv.FormatInt(int64(i), 10) + ")"
    }
    return _Pill_name[_Pill_index[i]:_Pill_index[i+1]]
}
```